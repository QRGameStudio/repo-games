<!DOCTYPE html><html lang=en><meta charset=UTF-8><meta content=1 name=gv><meta content=qrs.cakes name=gi><meta content=CAKESWP name=gs><title>Cakes swapper</title><meta content="width=device-width,initial-scale=1"name=viewport><style>#game-content,body,html{width:100%;height:100%;background-color:var(--theme-primary);color:var(--theme-contrast)}.block{position:absolute;border:1px solid #000;border-bottom:none;height:8vh}.block.light{background-color:#ff6bd2}.block.dark{background-color:#462528}.block.selected{opacity:50%}.tableStand{position:absolute;background-color:#915200;border:1px solid #000;border-top:none;width:2vw;height:40vh;bottom:6vh}.tableDesk{position:absolute;bottom:46vh;height:4vh;background-color:#915200;border:1px solid #000;border-bottom:none;width:20vw}.button{z-index:999;height:100vh;width:33vw;position:absolute;background-color:transparent}.scoreBox{position:absolute;right:32px;top:16px;font-family:Roboto,Helvetica,Arial,sans-serif;font-size:32px}.hScoreBox{position:absolute;right:32px;top:56px;font-family:Roboto,Helvetica,Arial,sans-serif;font-size:16px}</style><div id=gameContent></div><div class=tableStand style=left:19vw></div><div class=tableDesk style=left:10vw></div><div class=tableStand style=left:49vw></div><div class=tableDesk style=left:40vw></div><div class=tableStand style=left:79vw></div><div class=tableDesk style=left:70vw></div><div class=button style=left:0 id=leftBtn></div><div class=button style=left:33vw id=middleBtn></div><div class=button style=left:66vw id=rightBtn></div><script>var e=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var c,o=0,s=t.length;o<s;o++)!c&&o in t||(c||(c=Array.prototype.slice.call(t,0,o)),c[o]=t[o]);return e.concat(c||Array.prototype.slice.call(t))},t=function(){return function(e){var t=this;this.clear=function(){return t.container.innerHTML=""},this.drawTower=function(e,n){var c=e.stack,o=e.selected;c.reverse().forEach(function(e,s){var r=Math.floor(16*(e.size+1)/t.game.MAX),a=document.createElement("div");a.className="block ".concat(0===e.color?"light":"dark","  ").concat(o&&c.length-1==s?"selected":""),a.style.left="".concat(n+10-Math.floor(r/2),"vw"),a.style.width="".concat(r,"vw"),a.style.bottom="".concat(50+8*s,"vh"),a.style.zIndex="".concat(100-s),t.container.appendChild(a)})},this.drawScore=function(){var e=document.createElement("div");if(e.className="scoreBox",e.innerHTML="Moves: ".concat(t.game.getMoves()),t.container.appendChild(e),t.game.getBestMoves()>=0){var n=document.createElement("div");n.className="hScoreBox",n.innerHTML="Best: ".concat(t.game.getBestMoves()),t.container.appendChild(n)}},this.draw=function(){t.clear(),t.drawTower(t.game.getStack(0),10),t.drawTower(t.game.getStack(1),40),t.drawTower(t.game.getStack(2),70),t.drawScore()},this.game=e,this.container=document.getElementById("gameContent")}}(),n=function(){return function(n,c){var o=this;this.loadBest=function(){o.best=-1,new GStorage("QRHanoiTowers").get("HS",-1).then(function(e){o.best=parseInt(e),o.view.draw()})},this.saveBest=function(){(-1===o.best||o.best>o.moves)&&(o.best=o.moves,new GStorage("QRHanoiTowers").set("HS",o.best.toString()))},this.move=function(e,t){var n=o.stacks[e],c=o.stacks[t];0!==n.length&&(c.length>0&&n[0].size>c[0].size||(c.unshift(n.shift()),o.moves+=1,o.testWin()&&(o.saveBest(),(new GSongLib).play("successLong"),o.gameOverHandler())))},this.testWin=function(){return 0===o.stacks[0].filter(function(e){return 0===e.color}).length&&0===o.stacks[1].length&&0===o.stacks[2].filter(function(e){return 1===e.color}).length},this.getStack=function(t){return{stack:e([],o.stacks[t],!0),selected:t===o.selectedStack}},this.getMoves=function(){return o.moves},this.getBestMoves=function(){return o.best},this.click=function(e){-1===o.selectedStack?o.selectedStack=e:o.selectedStack===e?o.selectedStack=-1:(o.move(o.selectedStack,e),o.selectedStack=-1),o.view.draw()},this.stacks=[new Array(n).fill(0).map(function(e,t){return{color:0,size:t}}),[],new Array(n).fill(0).map(function(e,t){return{color:1,size:t}})],this.selectedStack=-1,this.gameOverHandler=c,this.MAX=n,this.moves=0,this.loadBest(),this.view=new t(this),this.view.draw()}}(),c=function(e){(new GTheme).apply();var t=new n(e,function(){alert("Congratulations, you won"),c(4)});document.getElementById("leftBtn").onclick=function(){return t.click(0)},document.getElementById("middleBtn").onclick=function(){return t.click(1)},document.getElementById("rightBtn").onclick=function(){return t.click(2)}};c(4);</script>